<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>给濛濛的爱心弹窗</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-image: url('濛濛和戴老师.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-color: rgba(255, 255, 255, 0.3);
            background-blend-mode: lighten;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
        }

        #container {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .popup {
            position: absolute;
            width: 120px;
            height: 50px;
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 14px;
            font-weight: bold;
            text-align: center;
            padding: 8px;
            color: #333;
            cursor: pointer;
            overflow: hidden;
            transition: transform 0.3s ease;
            z-index: 10;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        .popup:hover {
            transform: scale(1.15);
            z-index: 1000;
        }

        .heart {
            position: absolute;
            font-size: 12px;
            z-index: 1;
            animation: fall linear forwards;
            pointer-events: none;
            text-shadow: 0 0 2px rgba(0, 0, 0, 0.2);
        }

        .heart.paused {
            animation-play-state: paused;
        }

        @keyframes fall {
            to {
                transform: translateY(100px);
                opacity: 0;
            }
        }

        #message {
            position: absolute;
            width: 150px;
            height: 60px;
            background: linear-gradient(135deg, #ff8fab, #fb6f92);
            color: white;
            border-radius: 12px;
            display: none;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            font-weight: bold;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            z-index: 100;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        #instructions {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            text-align: center;
            color: white;
            font-size: 14px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            z-index: 5;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 8px;
            border-radius: 10px;
            margin: 0 20px;
        }

        .title {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            text-align: center;
            color: white;
            font-size: 24px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
            z-index: 5;
        }

        /* 自定义弹窗样式 */
        #customAlert {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        #customAlert .alertContent {
            background-color: white;
            padding: 20px;
            border-radius: 12px;
            max-width: 400px;
            width: 80%;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        #customAlert .alertButtons {
            margin-top: 20px;
        }

        #customAlert button {
            background: linear-gradient(135deg, #ff8fab, #fb6f92);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="title">Hi，濛濛</div>
    <div id="container"></div>
    <div id="message">濛濛，我喜欢你</div>
    <div id="instructions">戴老师！！！撒娇.jpg</div>
    
    <!-- 自定义弹窗 -->
    <div id="customAlert">
        <div class="alertContent">
            <div id="alertMessage"></div>
            <div class="alertButtons">
                <button id="alertOk">啵啵</button>
            </div>
        </div>
    </div>

    <script>
        // 马卡龙配色方案
        const colorPalette = [
            '#FFB3C1', '#FFDAC1', '#E2F0CB', '#B5EAD7',
            '#C7CEEA', '#FF9AA2', '#FFB7B2', '#FFDAC1',
            '#E2F0CB', '#B5EAD7', '#C7CEEA', '#F8B195',
            '#F67280', '#C06C84', '#6C5B7B', '#355C7D',
            '#A8E6CF', '#DCEDC1', '#FFD3B6', '#FFAAA5',
            '#FF8B94', '#FFAAA5', '#FFD3B6', '#DCEDC1'
        ];

        // 爱心颜色
        const heartColors = [
            '#FF6B6B', '#FF8E8E', '#FFAAAA', '#FFC4C4',
            '#FF6B6B', '#FF8E8E', '#FFAAAA', '#FFC4C4'
        ];

        // 弹窗文本内容 - 为濛濛定制
        const messages = [
            "濛濛，我喜欢你", "濛濛辛苦了", "濛濛真美", "想濛濛了",
            "濛濛加班加油", "濛濛注意休息", "濛濛多喝热水", "濛濛累不累",
            "濛濛吃饭了吗", "濛濛早点回家", "濛濛注意安全", "濛濛我想你了",
            "濛濛最可爱", "濛濛真优秀", "濛濛我想你", "濛濛别太累",
            "濛濛要开心", "濛濛笑一个", "濛濛抱抱", "濛濛亲亲",
            "濛濛好想你", "濛濛辛苦了", "濛濛真棒", "濛濛最美丽",
            "濛濛我等你", "濛濛要幸福", "濛濛好可爱", "濛濛真温柔",
            "濛濛好贴心", "濛濛真善良", "濛濛好聪明", "濛濛真有趣",
            "濛濛好迷人", "濛濛真独特", "濛濛好温暖", "濛濛真甜美",
            "濛濛好优雅", "濛濛真活泼", "濛濛好阳光", "濛濛真浪漫"
        ];

        // 弹窗详细内容 - 为濛濛定制
        const detailedMessages = {
            "濛濛，我喜欢你": "濛濛，我喜欢你。",
            "濛濛辛苦了": "濛濛，工作辛苦了。",
            "濛濛真美": "濛濛，你永远是最美的。",
            "想濛濛了": "濛濛，每分每秒都在想你，好想去公司找你。",
            "濛濛加班加油": "濛濛，加班辛苦了，怎么可以加班这么晚！",
            "濛濛注意休息": "濛濛，工作再忙也要注意休息，摸摸鱼嘿嘿嘿。",
            "濛濛多喝热水": "濛濛，多喝热水，可以起来走两步。",
            "濛濛累不累": "濛濛，累不累？给你按按腰，按按背。",
            "濛濛吃饭了吗": "濛濛，按时吃饭了吗？不要吃楼下超市的东西了",
            "濛濛早点回家": "濛濛，回家路上给我打电话，随时在线。",
            "濛濛注意安全": "濛濛，路上注意安全，不要跟陌生人走哦。",
            "濛濛我想你了": "濛濛，好想你好想你。",
            "濛濛最可爱": "濛濛，你是最可爱的！！！",
            "濛濛真优秀": "濛濛，你总是那么优秀，你会的好多。",
            "濛濛我想你": "濛濛，我想你了，想抱着你。",
            "濛濛别太累": "濛濛，别太累了，起来走走吧。",
            "濛濛要开心": "濛濛，希望每天开开心心哦。",
            "濛濛笑一个": "濛濛，笑一个好吗？你笑起来真好看，像春天的花一样",
            "濛濛抱抱": "濛濛，抱抱，宝宝。",
            "濛濛亲亲": "濛濛，kisskiss，色鬼上身啦！",
            "濛濛好想你": "濛濛，真的好想你，想立刻飞到你的身边。",
            "濛濛辛苦了": "濛濛，工作辛苦啦！",
            "濛濛真棒": "濛濛，你真棒！无论遇到什么困难，你都能勇敢面对。",
            "濛濛最美丽": "濛濛，你是最最最最最美丽的！！！",
            "濛濛我等你": "濛濛，等你下班。",
            "濛濛要幸福": "濛濛，永远幸福，我要努力让你幸福。",
            "濛濛好可爱": "濛濛，你总是那么可爱，rua一下。",
            "濛濛真温柔": "濛濛，你怎么这么温柔，想欺负。",
            "濛濛好贴心": "濛濛，你总是那么贴心，贴心小宝贝。",
            "濛濛真善良": "濛濛，你的善良让我感到这个世界的美好。",
            "濛濛好聪明": "濛濛，聪明伶俐的小朋友！",
            "濛濛真有趣": "濛濛，你总是那么有趣，永远不会无聊。",
            "濛濛好迷人": "濛濛，太让人着迷了，认真脸。",
            "濛濛真独特": "濛濛，你真的很特别。",
            "濛濛好温暖": "濛濛，你的存在让我变得温暖。",
            "濛濛真甜美": "濛濛，好甜，舔舔。",
            "濛濛好优雅": "濛濛，皮衣和西装超级优雅。",
            "濛濛真活泼": "濛濛，活泼开朗，充满活力。",
            "濛濛好阳光": "濛濛，你就像阳光一样，照亮了我的生活。",
            "濛濛真浪漫": "濛濛，和你在一起的每一刻都充满了浪漫。"
        };

        class PopupManager {
            constructor() {
                this.popups = [];
                this.container = document.getElementById('container');
                this.message = document.getElementById('message');
                this.customAlert = document.getElementById('customAlert');
                this.alertMessage = document.getElementById('alertMessage');
                this.alertOk = document.getElementById('alertOk');
                this.heartPositions = this.generateHeartPositions(150);
                this.currentIndex = 0;
                this.animationPhase = 0;
                this.gatherZIndex = 200;
                this.heartIntervals = []; // 存储所有爱心动画的计时器
                
                this.init();
                this.setupCustomAlert();
            }

            // 设置自定义弹窗
            setupCustomAlert() {
                this.alertOk.addEventListener('click', () => {
                    this.hideCustomAlert();
                });
            }

            // 显示自定义弹窗
            showCustomAlert(message) {
                this.alertMessage.textContent = message;
                this.customAlert.style.display = 'flex';
                
                // 暂停所有爱心动画
                this.pauseAllHeartAnimations();
            }

            // 隐藏自定义弹窗
            hideCustomAlert() {
                this.customAlert.style.display = 'none';
                
                // 恢复所有爱心动画
                this.resumeAllHeartAnimations();
            }

            // 暂停所有爱心动画
            pauseAllHeartAnimations() {
                const hearts = document.querySelectorAll('.heart');
                hearts.forEach(heart => {
                    heart.classList.add('paused');
                });
            }

            // 恢复所有爱心动画
            resumeAllHeartAnimations() {
                const hearts = document.querySelectorAll('.heart');
                hearts.forEach(heart => {
                    heart.classList.remove('paused');
                });
            }

            // 生成爱心形状的位置
            generateHeartPositions(count) {
                const positions = [];
                const centerX = window.innerWidth / 2;
                const centerY = window.innerHeight / 2;
                const scale = Math.min(window.innerWidth, window.innerHeight) / 2.5;
                
                for (let i = 0; i < count; i++) {
                    const t = (i / count) * Math.PI * 2;
                    const x = 16 * Math.pow(Math.sin(t), 3);
                    const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
                    
                    positions.push({
                        x: centerX - x * scale / 16,
                        y: centerY - y * scale / 16
                    });
                }
                
                return positions;
            }

            init() {
                for (let i = 0; i < this.heartPositions.length; i++) {
                    this.createPopup(i);
                }
                
                this.startAnimationSequence();
            }

            createPopup(index) {
                const popup = document.createElement('div');
                popup.className = 'popup';
                
                const colorIndex = Math.floor(Math.random() * colorPalette.length);
                const messageIndex = Math.floor(Math.random() * messages.length);
                const message = messages[messageIndex];
                
                popup.style.backgroundColor = colorPalette[colorIndex];
                popup.textContent = message;
                
                popup.style.left = '50%';
                popup.style.top = '50%';
                popup.style.transform = 'translate(-50%, -50%) scale(0)';
                
                // 使用自定义弹窗替代alert
                popup.addEventListener('click', () => {
                    this.showCustomAlert(detailedMessages[message] || "濛濛，这是一个特别的消息！");
                });
                
                this.container.appendChild(popup);
                this.popups.push({
                    element: popup,
                    index: index,
                    color: colorPalette[colorIndex],
                    message: message,
                    vx: 0,
                    vy: 0
                });
                
                this.startHeartAnimation(popup);
            }

            startHeartAnimation(popup) {
                // 存储计时器ID，以便后续清除
                const intervalId = setInterval(() => {
                    const heart = document.createElement('div');
                    heart.className = 'heart';
                    heart.innerHTML = '❤';
                    heart.style.color = heartColors[Math.floor(Math.random() * heartColors.length)];
                    heart.style.left = Math.random() * 100 + 10 + 'px';
                    heart.style.top = '-10px';
                    heart.style.animationDuration = (Math.random() * 2 + 1) + 's';
                    
                    popup.appendChild(heart);
                    
                    setTimeout(() => {
                        if (popup.contains(heart)) {
                            popup.removeChild(heart);
                        }
                    }, 3000);
                }, 500);
                
                this.heartIntervals.push(intervalId);
            }

            startAnimationSequence() {
                this.showPopupsSequentially();
                
                setTimeout(() => {
                    this.animationPhase = 1;
                    
                    setTimeout(() => {
                        this.animationPhase = 2;
                        this.scatterPopups();
                        
                        setTimeout(() => {
                            this.animationPhase = 3;
                            this.gatherPopups();
                        }, 3000);
                    }, 2000);
                }, this.heartPositions.length * 120 + 500);
            }

            showPopupsSequentially() {
                if (this.currentIndex < this.popups.length) {
                    const popup = this.popups[this.currentIndex];
                    const targetPos = this.heartPositions[popup.index];
                    
                    popup.element.style.transition = 'all 0.8s ease';
                    popup.element.style.left = targetPos.x + 'px';
                    popup.element.style.top = targetPos.y + 'px';
                    popup.element.style.transform = 'translate(-50%, -50%) scale(1)';
                    
                    this.currentIndex++;
                    setTimeout(() => this.showPopupsSequentially(), 120);
                }
            }

            scatterPopups() {
                this.popups.forEach(popup => {
                    const angle = Math.random() * Math.PI * 2;
                    const speed = 2 + Math.random() * 3;
                    
                    popup.vx = Math.cos(angle) * speed;
                    popup.vy = Math.sin(angle) * speed;
                    
                    popup.element.style.transition = 'none';
                });
                
                this.animateScattering();
            }

            animateScattering() {
                let allOut = true;
                
                this.popups.forEach(popup => {
                    const rect = popup.element.getBoundingClientRect();
                    let x = parseFloat(popup.element.style.left) + popup.vx;
                    let y = parseFloat(popup.element.style.top) + popup.vy;
                    
                    popup.element.style.left = x + 'px';
                    popup.element.style.top = y + 'px';
                    
                    if (x > -100 && x < window.innerWidth + 100 && 
                        y > -50 && y < window.innerHeight + 50) {
                        allOut = false;
                    }
                });
                
                if (!allOut && this.animationPhase === 2) {
                    requestAnimationFrame(() => this.animateScattering());
                }
            }

            gatherPopups() {
                const centerX = window.innerWidth / 2;
                const centerY = window.innerHeight / 2;
                
                this.gatherZIndex = 200;
                
                this.popups.forEach((popup, index) => {
                    popup.element.style.transition = 'all 1.2s ease';
                    
                    setTimeout(() => {
                        popup.element.style.zIndex = (this.gatherZIndex++).toString();
                        popup.element.style.left = centerX + 'px';
                        popup.element.style.top = centerY + 'px';
                        popup.element.style.transform = 'translate(-50%, -50%) scale(1)';
                        
                        if (index === this.popups.length - 1) {
                            setTimeout(() => {
                                this.popups.forEach(p => {
                                    p.element.style.display = 'none';
                                });
                                
                                this.message.style.display = 'flex';
                                this.message.style.left = centerX + 'px';
                                this.message.style.top = centerY + 'px';
                                this.message.style.transform = 'translate(-50%, -50%)';
                                this.message.style.zIndex = '1000';
                                
                                this.message.addEventListener('click', () => {
                                    this.showCustomAlert("濛濛，我喜欢你，超级超级喜欢你。");
                                });
                            }, 1500);
                        }
                    }, index * 80);
                });
            }

            // 清理所有计时器
            cleanup() {
                this.heartIntervals.forEach(intervalId => {
                    clearInterval(intervalId);
                });
                this.heartIntervals = [];
            }
        }

        // 页面加载完成后初始化
        window.addEventListener('load', () => {
            const popupManager = new PopupManager();
            
            // 页面关闭时清理资源
            window.addEventListener('beforeunload', () => {
                popupManager.cleanup();
            });
        });

        // 窗口大小改变时刷新页面
        window.addEventListener('resize', () => {
            // 在实际应用中，这里应该重新计算位置，但为了简化，我们只是刷新页面
            // location.reload();
        });
    </script>
</body>
</html>